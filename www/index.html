<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, xheight=device-height, target-densitydpi=device-dpi" />
		<link rel="stylesheet" type="text/css" href="js/jquery.mobile-1.4.4/jquery.mobile-1.4.4.css" />
		<link rel="stylesheet" type="text/css" href="js/index.js" />
        <meta name="msapplication-tap-highlight" content="no" />
        <title>Jellyfish Demo </title>

		<script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.1/jquery-2.1.1.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.4/jquery.mobile-1.4.4.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<style>
			.anchor_img {
				margin:0;
				margin-left:-30px;
				padding:0;
				border-width:0;
				border-color:#79CDF1;
				background-color:#79CDF1;
				-webkit-box-shadow: 0 0 0 rgba(0,0,0,0);
				-moz-box-shadow: 0 0 0 rgba(0,0,0,0);
				box-shadow:  0 0 0 rgba(0,0,0,0);
			}
		
		</style>
    </head>
    <body>
		<div data-role="page" id="home">
			<div data-role="content" style="background-color:#79CDF1;">
				<div id="home-menu">
	                <a href="#drink" data-role="button" data-transition="slide" style="background-color:#79CDF1;" id="anchor_img1" ><image src="img/my-jellyfish.png" height="150" /></a>
	                <a href="#picture" data-role="button" data-transition="slide" style="background-color:#79CDF1;" id="anchor_img2" ><image src="img/my-photo.png" height="150" /></a>
	                <a href="#message" data-role="button"  data-transition="slide" class="ui-disabled" style="background-color:#79CDF1;" id="anchor_img3"> <image src="img/my-friend.png" height="150" /> </a>
	                <br>
	                <a href="#test" data-role="button"  data-transition="slide" style="background-color:#79CDF1; margin-left:-100px;" id="anchor_img4"> <image src="img/bowhead-technology.png" height="80" /> </a>
            	</div>

			</div>
		</div>

		<div data-role="page" id="drink" >
			<!--
			<div data-role="header" data-add-back-btn="true" style="background-color:#79CDF1">
				<h1>Drinking Demo</h1>
			</div>
			-->
			<div data-role="content"  style="background-color:#79CDF1">
				<div>
				  <a href="#" data-rel="back" ><image src="img/back.png"   style="height:100%; width:100%; margin-left:-30px;" /></a>	
				</div>
                <div class="blinking">
                <image src="img/jellyfish-water.png" style="height:100%; width:100%" />			
                </div>
			</div>
		</div>

		<div data-role="page" id="picture" data-add-back-btn="true">
			<div data-role="content" style="background-color:#79CDF1">
				<div>
				  <a href="#" data-rel="back" ><image src="img/back.png"   style="height:100%; width:100%; margin-left:-30px;" /></a>	
				</div>
				<div style="margin-left:-10px">	
					<table id="table-pic6" width="360px">
					<tr>
						<td width="10%"></td>
						<td width="30%">
						<a data-parm="img/1-black-white.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/1-black-white.jpg" width="100%"/></a>
						</td>
						<td width="20%"></td>
						<td width="30%">
						<a data-parm="img/2-heart.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/2-heart.jpg" width="100%"/></a>	
						</td>
						<td width="10%"></td>
					</tr>
					<tr>
						<td width="10%"></td>
						<td width="30%">
						<a data-parm="img/3-love.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/3-love.jpg" width="100%"/></a>
						</td>
						<td width="20%"></td>
						<td width="30%">
						<a data-parm="img/4-zebra-lady.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/4-zebra-lady.jpg" width="100%"/></a>	
						</td>
						<td width="10%"></td>
					</tr>
					<tr>
						<td width="10%"></td>
						<td width="30%">
						<a data-parm="img/5-men.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/5-men.jpg" width="100%"/></a>
						</td>
						<td width="20%"></td>
						<td width="30%">
						<a data-parm="img/6-horse.jpg" href="#pic_dialog" data-rel="dialog"><img src="img/6-horse.jpg" width="100%"/></a>	
						</td>
						<td width="10%"></td>
					</tr>					
					</table>
				</div>				
			</div>
		</div>

		<script type="text/javascript">
			$("a").on("click", function (event) {

			   var parm = $(this).attr("data-parm");
			   $("#pop_pic").attr("src",parm);

			});

			function close_send_picture() {
				$("#pic_dialog").dialog('close');
			}
			
			function send_picture() {
				var src = $("#pop_pic").attr("src");
				pic_no = parseInt(src[4]);  //img/?-xxx.jpg

				data_pic = "%B1Q,100," + pic_no + ",1,1\r\n";
				$("#server_msg").val(data_pic);

				setTimeout(close_send_picture,3000);

				$.mobile.loading('show', {text:"waiting", textVisible: true});
				disconnectAll(); 
				connect();
				send();
				$.mobile.loading('hide');
			}
		</script>		
		<div data-role="page" id="pic_dialog">
		  <div data-role="header" style="background-color:#79CDF1">
		    <h2>Selected Picture</h2>
		  </div>
		  <div>
		    <div id="showParmHere">
		    	<table id="table-pic1" witdh="320px">
		    	<tr>
			    	<td width="5%"></td>
			    	<td width="90%">
			    	<image id="pop_pic" src="img/1-black-white.jpg" height="480px" width="100%" style="text-align:center"/>
			    	</td>
			    	<td witdh="5%"></td>
			    </tr>
		    	<tr>
			    	<td width="5%"></td>
			    	<td width="90%">
			    	<a href="#" onclick="send_picture()"> <image src="img/send-02.png" width="100%"/></a>
		    		</td>
			    	<td width="5%"></td>
		    	</tr>
		    	</table>
		    </div>
		  </div>
		</div>


		<div data-role="page" id="message">
			<div data-role="header" data-add-back-btn="true">
				<h1>Message Demo</h1>
			</div>
			<div data-role="content">
                <div>
                <image src="img/jellyfish.png" style="height:100%; width:100%" />			
                </div>
			</div>
		</div>		
		
		<div data-role="page" id="test">
			<div data-role="header" data-add-back-btn="true">
				<h1>Socket test</h1>
			</div>
			<div data-role="content">
				<div data-role="xfieldcontain">
		         <label for="number">Server IP</label>
		         <input type="text"  id="server_ip" value="" data-clear-btn="true"/>
				</div>	
				<div data-role="xfieldcontain">
		         <label for="number">Port</label>
		         <input type="number"  id="server_port" value="" data-clear-btn="true" />
				</div>			
				<div data-role="xfieldcontain">
		         <label for="number">MessageToSend</label>
		         <input type="text"  id="server_msg" value="" data-clear-btn="true" />
				</div>	
				 <div>
	            	<br>
	            	<button onclick="connect()" data-icon="plus">Connect</button>
	            	<button onclick="send()" data-icon="action">Send</button>
	            	<button onclick="disconnect()" data-icon="minus">Disconnect</button><br>
	                <button onclick="isConnected()" data-icon="check">is Connected</button>
	                <button onclick="disconnectAll()" data-icon="delete">DisconnectAll</button>
	            </div>


				<div id="log" style="line-height:0.1; font-size:10pt;">
				</div>
				<div id="pre_dump" style="font-size:8pt;">
				</div>
			</div>		            
		</div>
        <script type="text/javascript">
            var host = "192.168.1.1";
            var port = 6000;
            var data = "%B1Q,100,1,1,1";
            var key = "";

            function initValues(){
            	$("#server_ip").val(host);
            	$("#server_port").val(port);
            	$("#server_msg").val(data);
            }

            initValues();
            addLog("log starts here...");

            function getValues() {
            	host = $("#server_ip").val();
            	port = parseInt($("#server_port").val());
            	data = $("#server_msg").val() + "\r\n";
            }
            
            function stub(d) {
            	console.log(d);
            	addLog(d);
            }
        
	        function onConnect(k) {
	            console.log('Established connection with ', k);
	            key = k;
	            addLog("connection key=" + key);
	        }
	        
	        function connect() {
	        	addLog("try connect...");
	        	//my_dump(window.tlantic, "window.tlantic");
	        	
	        	getValues();
	            window.tlantic.plugins.socket.connect(onConnect, stub, host, port);
	        }
	        
	        function send() {
	        	getValues();
	        	addLog("connection key=" + key);
	        	addLog("Message to send: " + data);
	            window.tlantic.plugins.socket.send(stub, stub, key, data);
	        }
	        
	        function disconnect() {
	        	getValues();
	        	addLog("connection key=" + key);
	            window.tlantic.plugins.socket.disconnect(stub, stub, key);
	        }
	        
	        function disconnectAll() {
	        	getValues();
	            window.tlantic.plugins.socket.disconnectAll(stub, stub);
	        }
	        
	        function isConnected() {
	        	getValues();
	            window.tlantic.plugins.socket.isConnected(key, stub, stub);
	        }
	        
	        document.addEventListener('SOCKET_RECEIVE_DATA_HOOK', function (ev) {
	                                  console.log('Data has been received: ', ev.metadata);

	                                  p = ev.metadata.data;
	                                  console.log(p);
	                                  addLog("Message Received: " + p);
	                                  
	                                  });

		</script>
		<script type="text/javascript">
			function ScaleContentToDevice(){
				scroll(0, 0);
				var content = $.mobile.getScreenHeight() - $(".ui-header").outerHeight() - $(".ui-footer").outerHeight() - $(".ui-content").outerHeight() + $(".ui-content").height();
				$(".ui-content").height(content);
			};  

			$(document).on( "pagecontainershow", function(){
				ScaleContentToDevice();        
			});

			$(window).on("resize orientationchange", function(){
				ScaleContentToDevice();
			});
		</script>
		<script type="text/javascript">
			function show_home_menu() {
				//$("#home-flash").css('display','none');
				//$("#home-menu").css('display','true');
			}

			$(function(){
				$("#home-flash").hide(20000);
			});
	
			$(function(){
				$("#anchor_img1").addClass("anchor_img");				
				$("#anchor_img2").addClass("anchor_img");				
				$("#anchor_img3").addClass("anchor_img");				
				$("#anchor_img4").addClass("anchor_img");
				//$("#home-menu").delay(2000).show(1);

				//$("#table-pic6").attr("width",$.mobile.getScreenWidth() );
				//$("#table-pic6").attr("width",$.mobile.getScreenWidth()-20 );
			});


		</script>
    </body>
</html>