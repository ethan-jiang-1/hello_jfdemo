<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, xheight=device-height, target-densitydpi=device-dpi" />
		<link rel="stylesheet" type="text/css" href="js/jquery.mobile-1.4.4/jquery.mobile-1.4.4.css" />
		<link rel="stylesheet" type="text/css" href="js/index.js" />
        <meta name="msapplication-tap-highlight" content="no" />
        <title>Jellyfish Demo </title>

		<script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.1/jquery-2.1.1.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.4/jquery.mobile-1.4.4.js"></script>
		<script type="text/javascript" src="js/index.js"></script>

    </head>
    <body>
		<div data-role="page" id="home"">
			<div data-role="content" style="background-color:#79CDF1;">
				<div id="home-flash" style="display:none;">
				 <image src="img/home-page.png" style="text-aligh:center" height="40%"" width="100%" />
				</div>
				<div id="home-menu" style="display:true">
                <a href="#drink" data-role="button" data-transition="slide" style="background-color:#79CDF1;" ><image src="img/my-jellyfish.png" height="200" /></a>
                <br>
                <a href="#picture" data-role="button" data-transition="slide" style="background-color:#79CDF1;" ><image src="img/my-photo.png" height="200" /></a>
                <br>
                <a href="#message" data-role="button"  data-transition="slide" class="ui-disabled" style="background-color:#79CDF1;"> <image src="img/my-friend.png" height="200" /> </a>
                <br>
                <a href="#test" data-role="button" data-icon="gear" data-transition="slide"> Socket Testing </a>	
                <br>
				</div>
			</div>
		</div>

		<div data-role="page" id="drink" >
			<!--
			<div data-role="header" data-add-back-btn="true" style="background-color:#79CDF1">
				<h1>Drinking Demo</h1>
			</div>
			-->
			<div data-role="content"  style="background-color:#79CDF1">
				<div>
				  <a href="#" data-rel="back" ><image src="img/back.png"   style="height:100%; width:100%" /></a>	
				</div>
                <div class="blinking">
                <image src="img/jellyfish-water.png" style="height:100%; width:100%" />			
                </div>
			</div>
		</div>

		<div data-role="page" id="picture" data-add-back-btn="true">
			<div data-role="header" data-add-back-btn="true">
				<h1>Picture Demo</h1>
			</div>
			<div data-role="content">
				<ul data-role="listview" data-icon="refresh">
					<li><a href="#" onclick="changePicture(1);">
						<img src="img/1-black-white.jpg" />
						<h3>Black-white</h3>
						<p id="lvp1"></p>
						</a>
					</li>
					<li><a href="#" onclick="changePicture(2);">
						<img src="img/2-heart.jpg" />
						<h3>Heart</h3>
						<p id="lvp2"></p>
						</a>
					</li>					
					<li><a href="#" onclick="changePicture(3);">
						<img src="img/3-love.jpg" />
						<h3>Love</h3>
						<p id="lvp3"></p>
						</a>
					</li>
					<li><a href="#" onclick="changePicture(4);">
						<img src="img/4-zebra-lady.jpg" />
						<h3>Zebra Lady</h3>
						<p id="lvp4"></p>
						</a>
					</li>					
					<li><a href="#" onclick="changePicture(5);">
						<img src="img/5-men.jpg" />
						<h3>Men</h3>
						<p id="lvp5"></p>
						</a>
					</li>
					<li><a href="#" onclick="changePicture(6);">
						<img src="img/6-horse.jpg" />
						<h3>Horse</h3>
						<p id="lvp6"></p>
						</a>
					</li>
				</ul>				
			</div>
		</div>
		<script type="text/javascript">
			function changePicture(pno) {
				for (i=1;i<=6;i++) {
					ipno = "#lvp" + i;
					$(ipno).html("");
				}

				ipno = "#lvp" + pno; 
				$(ipno).html("selected to change");
			}
		</script>

		<div data-role="page" id="message">
			<div data-role="header" data-add-back-btn="true">
				<h1>Message Demo</h1>
			</div>
			<div data-role="content">
                <div>
                <image src="img/jellyfish.png" style="height:100%; width:100%" />			
                </div>
			</div>
		</div>		
		
		<div data-role="page" id="test">
			<div data-role="header" data-add-back-btn="true">
				<h1>Socket test</h1>
			</div>
			<div data-role="content">
				<div data-role="fieldcontain">
		         <label for="number">Server IP</label>
		         <input type="text"  id="server_ip" value="" data-clear-btn="true"/>
				</div>	
				<div data-role="fieldcontain">
		         <label for="number">Port</label>
		         <input type="number"  id="server_port" value="" data-clear-btn="true" />
				</div>			
				<div data-role="fieldcontain">
		         <label for="number">MessageToSend</label>
		         <input type="text"  id="server_msg" value="" data-clear-btn="true" />
				</div>	
				 <div>
	            	<br>
	            	<button onclick="connect()" data-icon="plus">Connect</button>
	            	<button onclick="send()" data-icon="action">Send</button>
	            	<button onclick="disconnect()" data-icon="minus">Disconnect</button><br>
	                <button onclick="isConnected()" data-icon="check">is Connected</button>
	                <button onclick="disconnectAll()" data-icon="delete">DisconnectAll</button>
	            </div>


				<div id="log" style="line-height:0.1; font-size:10pt;">
				</div>
				<div id="pre_dump" style="font-size:8pt;">
				</div>
			</div>		            
		</div>
        <script type="text/javascript">
            var host = "192.168.1.1";
            var port = 6000;
            var data = "%B1Q,100,1,1,1";
            var key = "";

            function initValues(){
            	$("#server_ip").val(host);
            	$("#server_port").val(port);
            	$("#server_msg").val(data);
            }

            initValues();
            addLog("log starts here...");

            function getValues() {
            	host = $("#server_ip").val();
            	port = parseInt($("#server_port").val());
            	data = $("#server_msg").val() + "\r\n";
            }
            
            function stub(d) {
            	console.log(d);
            	addLog(d);
            }
        
	        function onConnect(k) {
	            console.log('Established connection with ', k);
	            key = k;
	            addLog("connection key=" + key);
	        }
	        
	        function connect() {
	        	addLog("try connect...");
	        	//my_dump(window.tlantic, "window.tlantic");
	        	
	        	getValues();
	            window.tlantic.plugins.socket.connect(onConnect, stub, host, port);
	        }
	        
	        function send() {
	        	getValues();
	        	addLog("connection key=" + key);
	        	addLog("Message to send: " + data);
	            window.tlantic.plugins.socket.send(stub, stub, key, data);
	        }
	        
	        function disconnect() {
	        	getValues();
	        	addLog("connection key=" + key);
	            window.tlantic.plugins.socket.disconnect(stub, stub, key);
	        }
	        
	        function disconnectAll() {
	        	getValues();
	            window.tlantic.plugins.socket.disconnectAll(stub, stub);
	        }
	        
	        function isConnected() {
	        	getValues();
	            window.tlantic.plugins.socket.isConnected(key, stub, stub);
	        }
	        
	        document.addEventListener('SOCKET_RECEIVE_DATA_HOOK', function (ev) {
	                                  console.log('Data has been received: ', ev.metadata);

	                                  p = ev.metadata.data;
	                                  console.log(p);
	                                  addLog("Message Received: " + p);
	                                  
	                                  });

		</script>
		<script type="text/javascript">
			function ScaleContentToDevice(){
				scroll(0, 0);
				var content = $.mobile.getScreenHeight() - $(".ui-header").outerHeight() - $(".ui-footer").outerHeight() - $(".ui-content").outerHeight() + $(".ui-content").height();
				$(".ui-content").height(content);
			};  

			$(document).on( "pagecontainershow", function(){
				ScaleContentToDevice();        
			});

			$(window).on("resize orientationchange", function(){
				ScaleContentToDevice();
			});
		</script>
		<script type="text/javascript">
			$(function(){
				//$("#home-flash").delay(2000).hide(1);
				//$("#home-menu").delay(2000).show(1);
			});
	
		</script>
    </body>
</html>